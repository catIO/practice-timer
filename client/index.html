<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
  <link rel="mask-icon" href="/icons/icon-monochrome.svg" color="#000000">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#000000" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">
  <meta name="description" content="A timer app for practice sessions with work and break intervals" />
  <link rel="manifest" href="/manifest.json" />
  <title>Practice Timer</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script>
    // Enhanced iPad detection that works with new iPadOS behavior
    const detectIPad = () => {
      // Check for iPad-specific user agent (older iPads)
      if (/iPad/.test(navigator.userAgent)) {
        return true;
      }
      
      // Check for new iPadOS behavior where iPad reports as Macintosh
      if (/Macintosh/.test(navigator.userAgent)) {
        // Check if it has touch support (iPad has touch, Mac doesn't)
        if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
          // Check screen size (iPad typically has larger screen than iPhone)
          const screenWidth = window.screen.width;
          const screenHeight = window.screen.height;
          const minDimension = Math.min(screenWidth, screenHeight);
          const maxDimension = Math.max(screenWidth, screenHeight);
          
          // iPad typically has screen dimensions like 768x1024, 834x1194, etc.
          if (minDimension >= 768 && maxDimension >= 1024) {
            return true;
          }
        }
      }
      
      return false;
    };

    // Handle iPad consistently across all browsers
    if (detectIPad()) {
      console.log('iPad detected, applying consistent layout...');
      
      // Set mobile-specific properties (same for all browsers)
      document.documentElement.style.setProperty('--mobile-layout', 'true');
      document.body.classList.add('mobile-layout');
      
      // Use responsive viewport (same for all browsers)
      const viewport = document.querySelector('meta[name="viewport"]');
      if (viewport) {
        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
      }
      
      // Add additional mobile indicators (same for all browsers)
      document.documentElement.classList.add('mobile-device');
      document.body.classList.add('ipad-mobile');
      
      // Set iPad flag for any scripts that need it
      window.isIPad = true;
      
      // Initialize audio context for iPad to ensure sound works
      const initializeAudioForIPad = async () => {
        try {
          // Create audio context to unlock audio on iPad
          const AudioContext = window.AudioContext || window.webkitAudioContext;
          const audioContext = new AudioContext();
          
          // Resume audio context if suspended
          if (audioContext.state === 'suspended') {
            await audioContext.resume();
          }
          
          // Create a silent oscillator to unlock audio
          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();
          
          oscillator.connect(gainNode);
          gainNode.connect(audioContext.destination);
          
          // Set very low volume (silent unlock)
          gainNode.gain.setValueAtTime(0.001, audioContext.currentTime);
          oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
          
          oscillator.start(audioContext.currentTime);
          oscillator.stop(audioContext.currentTime + 0.1);
          
          console.log('iPad audio context initialized successfully');
        } catch (error) {
          console.log('iPad audio initialization failed:', error);
        }
      };
      
      // Initialize audio when user interacts with the page
      const initAudioOnInteraction = () => {
        initializeAudioForIPad();
        document.removeEventListener('touchstart', initAudioOnInteraction);
        document.removeEventListener('click', initAudioOnInteraction);
      };
      
      // Listen for user interaction to initialize audio
      document.addEventListener('touchstart', initAudioOnInteraction);
      document.addEventListener('click', initAudioOnInteraction);
    }
  </script>
</head>
<body class="font-sans antialiased">
  <div id="root"></div>
  <script type="module" src="/src/main.tsx"></script>
</body>
</html>
